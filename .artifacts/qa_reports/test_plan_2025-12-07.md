# Alpha-Sam 테스트 계획서

**작성일**: 2025-12-07  
**작성자**: QA Tester  
**프로젝트**: Alpha-Sam (AI 기반 자산 관리 대시보드)

---

## 1. 테스트 환경

### 1.1 환경 구성
- **Docker Compose** 기반 로컬 테스트 환경
- **Backend**: FastAPI (포트 8000)
- **Frontend**: SvelteKit (nginx를 통한 리버스 프록시, 포트 80)
- **Database**: PostgreSQL 16
- **Cache**: Redis 7
- **Celery**: Worker + Beat (백그라운드 작업)

### 1.2 테스트 환경 설정 방법
```bash
# 1. Docker Compose로 전체 스택 기동
docker compose up -d

# 2. 서비스 상태 확인
docker compose ps

# 3. Backend API 문서 확인
# 브라우저에서 http://localhost:8000/docs 접속

# 4. Frontend 접속
# 브라우저에서 http://localhost 접속
```

### 1.3 테스트 데이터 준비
- 샘플 Asset: BTC (Bitcoin), ETH (Ethereum), AAPL (Apple Inc.)
- 샘플 Position: 각 Asset에 대한 보유 내역
- 시세 데이터: 외부 API를 통한 실제 시세 조회

---

## 2. 핵심 사용자 시나리오 테스트

### 2.1 시나리오 1: 자산 등록 및 포지션 추가

**목적**: 기본적인 자산 관리 워크플로우 검증

**테스트 절차**:
1. Asset 등록
   - Symbol: `BTC`
   - Name: `Bitcoin`
   - Category: `crypto` (선택)
2. Position 추가
   - Asset ID: 위에서 생성한 Asset ID
   - Quantity: `1.5`
   - Buy Price: `95000`
   - Buy Date: `2025-01-01` (선택)
3. 시세 새로고침
   - `/api/v1/prices/refresh` 엔드포인트 호출
4. 수익률/평가액 확인
   - Asset 목록 조회 (`GET /api/v1/assets`)
   - Position 목록 조회 (`GET /api/v1/positions`)
   - 계산된 값 검증:
     - `valuation = current_price * quantity`
     - `profit_loss = (current_price - buy_price) * quantity`
     - `return_rate = ((current_price - buy_price) / buy_price) * 100`

**기대 결과**:
- Asset이 정상적으로 생성됨
- Position이 정상적으로 생성됨
- 시세가 정상적으로 조회되고 저장됨
- 수익률, 평가액, 손익이 올바르게 계산되어 표시됨

**테스트 결과**: ⏳ 대기 중 (테스트 실행 후 기록)

---

### 2.2 시나리오 2: 여러 자산 관리

**목적**: 포트폴리오 단위의 관리 기능 검증

**테스트 절차**:
1. 여러 Asset 등록
   - BTC (Bitcoin)
   - ETH (Ethereum)
   - AAPL (Apple Inc.)
2. 각 Asset에 Position 추가
   - BTC: Quantity 1.5, Buy Price 95000
   - ETH: Quantity 5.0, Buy Price 3000
   - AAPL: Quantity 10, Buy Price 150
3. 시세 새로고침
4. 포트폴리오 요약 확인
   - 총 평가액 = 모든 Position의 valuation 합
   - 총 손익 = 모든 Position의 profit_loss 합
   - 포트폴리오 수익률 = 원금 가중 수익률 계산

**기대 결과**:
- 모든 Asset과 Position이 정상적으로 생성됨
- 각 자산별 수익률이 올바르게 계산됨
- 포트폴리오 전체 요약이 올바르게 집계됨

**테스트 결과**: ⏳ 대기 중 (테스트 실행 후 기록)

---

### 2.3 시나리오 3: 포지션 수정/삭제

**목적**: 포지션 변경 및 삭제 기능 검증

**테스트 절차**:
1. 기존 Position 수정
   - Position ID로 수량 변경 (예: 1.5 → 2.0)
   - `PUT /api/v1/positions/{position_id}` 호출
2. 수익률 재계산 확인
   - 수정 후 Position 조회
   - 수익률, 평가액, 손익이 새로운 수량으로 재계산되었는지 확인
3. Position 삭제
   - `DELETE /api/v1/positions/{position_id}` 호출
4. Asset 상태 확인
   - Position 삭제 후 Asset은 남아있어야 함
   - Asset 조회 시 Position 관련 메트릭은 null이어야 함

**기대 결과**:
- Position 수정이 정상적으로 반영됨
- 수익률이 재계산됨
- Position 삭제 후 Asset은 유지됨
- Asset의 Position 관련 필드는 null로 표시됨

**테스트 결과**: ⏳ 대기 중 (테스트 실행 후 기록)

---

## 3. 에지 케이스 테스트

### 3.1 유효성 검증 테스트

#### TC-EDGE-001: quantity = 0인 경우
- **입력**: `quantity: 0`
- **기대 결과**: Position 생성은 허용되지만, 평가액/손익은 0으로 계산됨
- **테스트 결과**: ⏳ 대기 중

#### TC-EDGE-002: quantity < 0인 경우
- **입력**: `quantity: -1`
- **기대 결과**: `400 Bad Request` 에러, "quantity must be greater than or equal to 0"
- **테스트 결과**: ⏳ 대기 중

#### TC-EDGE-003: buy_price <= 0인 경우
- **입력**: `buy_price: 0` 또는 `buy_price: -100`
- **기대 결과**: `400 Bad Request` 에러, "buy_price must be greater than 0"
- **테스트 결과**: ⏳ 대기 중

#### TC-EDGE-004: 시세가 없는 Asset의 수익률 계산
- **상황**: Position은 있지만 Price가 없는 Asset
- **기대 결과**: 
  - `valuation`, `profit_loss`, `return_rate`는 `null`
  - 에러가 발생하지 않음
- **테스트 결과**: ⏳ 대기 중

#### TC-EDGE-005: 중복 Symbol 등록
- **입력**: 이미 존재하는 Symbol로 Asset 생성 시도
- **기대 결과**: `400 Bad Request` 에러, "Asset with symbol {symbol} already exists"
- **테스트 결과**: ⏳ 대기 중

#### TC-EDGE-006: 존재하지 않는 Asset에 Position 추가
- **입력**: 존재하지 않는 `asset_id`로 Position 생성 시도
- **기대 결과**: `404 Not Found` 에러, "Asset with id {asset_id} not found"
- **테스트 결과**: ⏳ 대기 중

#### TC-EDGE-007: 존재하지 않는 Position 조회/수정/삭제
- **입력**: 존재하지 않는 `position_id`로 조회/수정/삭제 시도
- **기대 결과**: `404 Not Found` 에러
- **테스트 결과**: ⏳ 대기 중

---

## 4. API 엔드포인트 테스트

### 4.1 Assets API

#### GET /api/v1/assets
- **목적**: Asset 목록 조회 (최신 시세 및 Position 메트릭 포함)
- **테스트 케이스**:
  - 빈 목록 조회
  - 여러 Asset 조회
  - Pagination (skip, limit) 동작 확인
- **테스트 결과**: ⏳ 대기 중

#### POST /api/v1/assets
- **목적**: Asset 생성
- **테스트 케이스**:
  - 정상 생성
  - 중복 Symbol 에러 처리
  - 필수 필드 누락 에러 처리
- **테스트 결과**: ⏳ 대기 중

#### DELETE /api/v1/assets/{asset_id}
- **목적**: Asset 삭제
- **테스트 케이스**:
  - 정상 삭제
  - 존재하지 않는 Asset 삭제 시도
- **테스트 결과**: ⏳ 대기 중

### 4.2 Positions API

#### GET /api/v1/positions
- **목적**: Position 목록 조회 (Asset 정보 및 계산된 메트릭 포함)
- **테스트 케이스**:
  - 빈 목록 조회
  - 여러 Position 조회
  - Pagination 동작 확인
- **테스트 결과**: ⏳ 대기 중

#### GET /api/v1/positions/{position_id}
- **목적**: 특정 Position 조회
- **테스트 케이스**:
  - 정상 조회
  - 존재하지 않는 Position 조회 시도
- **테스트 결과**: ⏳ 대기 중

#### POST /api/v1/positions
- **목적**: Position 생성
- **테스트 케이스**:
  - 정상 생성
  - 유효성 검증 (quantity < 0, buy_price <= 0)
  - 존재하지 않는 Asset에 Position 추가 시도
- **테스트 결과**: ⏳ 대기 중

#### PUT /api/v1/positions/{position_id}
- **목적**: Position 수정
- **테스트 케이스**:
  - 정상 수정
  - 부분 수정 (일부 필드만 업데이트)
  - 유효성 검증
- **테스트 결과**: ⏳ 대기 중

#### DELETE /api/v1/positions/{position_id}
- **목적**: Position 삭제
- **테스트 케이스**:
  - 정상 삭제
  - 존재하지 않는 Position 삭제 시도
- **테스트 결과**: ⏳ 대기 중

### 4.3 Prices API

#### POST /api/v1/prices/refresh
- **목적**: 모든 Asset의 시세 새로고침
- **테스트 케이스**:
  - 정상 새로고침
  - 빈 Asset 목록에서 새로고침
  - 외부 API 장애 시나리오 (선택적)
- **테스트 결과**: ⏳ 대기 중

---

## 5. 프론트엔드 UI 테스트

### 5.1 Asset 관리 UI

#### TC-UI-001: Asset 추가 모달
- **절차**: 
  1. 브라우저에서 Asset 추가 버튼 클릭
  2. 모달에서 Symbol, Name 입력
  3. 저장 버튼 클릭
- **기대 결과**: 
  - 모달이 정상적으로 표시됨
  - Asset이 목록에 추가됨
  - 성공 메시지 표시 (있는 경우)
- **테스트 결과**: ⏳ 대기 중

#### TC-UI-002: Asset 목록 표시
- **절차**: 
  1. 메인 페이지 접속
  2. Asset 목록 확인
- **기대 결과**: 
  - Asset 목록이 테이블/카드 형태로 표시됨
  - 최신 시세, 수익률, 평가액이 표시됨
  - Position이 없는 Asset은 메트릭이 null 또는 "N/A"로 표시됨
- **테스트 결과**: ⏳ 대기 중

### 5.2 Position 관리 UI

#### TC-UI-003: Position 추가 모달 (구현 후)
- **절차**: 
  1. Asset 선택 후 Position 추가 버튼 클릭
  2. 모달에서 Quantity, Buy Price 입력
  3. 저장 버튼 클릭
- **기대 결과**: 
  - 모달이 정상적으로 표시됨
  - Position이 생성되고 수익률이 계산됨
- **테스트 결과**: ⏳ 대기 중 (Position 기능 구현 후)

#### TC-UI-004: Position 수정/삭제 (구현 후)
- **절차**: 
  1. Position 목록에서 수정/삭제 버튼 클릭
  2. 수정 또는 삭제 수행
- **기대 결과**: 
  - 수정 시 변경사항이 반영됨
  - 삭제 시 목록에서 제거됨
- **테스트 결과**: ⏳ 대기 중 (Position 기능 구현 후)

### 5.3 에러 처리 UI

#### TC-UI-005: 에러 메시지 표시
- **절차**: 
  1. 잘못된 입력으로 Asset/Position 생성 시도
  2. 에러 발생 시나리오 재현
- **기대 결과**: 
  - 사용자 친화적인 에러 메시지 표시
  - 에러 메시지가 명확하고 이해하기 쉬움
- **테스트 결과**: ⏳ 대기 중

#### TC-UI-006: 로딩 상태 표시
- **절차**: 
  1. 시세 새로고침 버튼 클릭
  2. API 호출 중 로딩 상태 확인
- **기대 결과**: 
  - 로딩 인디케이터 표시
  - 사용자가 대기 중임을 인지할 수 있음
- **테스트 결과**: ⏳ 대기 중

---

## 6. 통합 테스트

### 6.1 전체 워크플로우 테스트

#### TC-INT-001: 전체 사용자 여정
1. Asset 등록 (BTC)
2. Position 추가 (Quantity: 1.5, Buy Price: 95000)
3. 시세 새로고침
4. 수익률 확인
5. Position 수정 (Quantity: 2.0)
6. 수익률 재계산 확인
7. 추가 Asset 등록 (ETH)
8. 추가 Position 추가
9. 포트폴리오 요약 확인

**기대 결과**: 모든 단계가 정상적으로 동작하고, 데이터 일관성이 유지됨

**테스트 결과**: ⏳ 대기 중

---

## 7. 성능 테스트 (선택적)

### 7.1 대량 데이터 테스트

#### TC-PERF-001: 많은 수의 Asset/Position
- **조건**: 100개 이상의 Asset, 각각에 Position
- **측정 항목**: 
  - Asset 목록 조회 응답 시간
  - Position 목록 조회 응답 시간
  - 페이지 로딩 속도
- **기대 결과**: 
  - 응답 시간이 2초 이내
  - 페이지 로딩이 3초 이내
- **테스트 결과**: ⏳ 대기 중 (선택적)

#### TC-PERF-002: 시세 새로고침 성능
- **조건**: 50개 이상의 Asset
- **측정 항목**: 
  - 시세 새로고침 API 응답 시간
  - 외부 API 호출 시간
- **기대 결과**: 
  - 전체 새로고침이 30초 이내 완료
- **테스트 결과**: ⏳ 대기 중 (선택적)

---

## 8. 테스트 실행 일정

1. ✅ 테스트 계획 수립 (2025-12-07)
2. ⏳ 테스트 환경 설정 확인
3. ⏳ API 엔드포인트 테스트 (FastAPI /docs 사용)
4. ⏳ 프론트엔드 UI 테스트 (브라우저)
5. ⏳ 통합 테스트
6. ⏳ 테스트 리포트 작성

---

## 9. 발견된 버그 (Bug Report)

버그가 발견되면 아래 형식으로 기록합니다.

### 버그 템플릿
```
**버그 ID**: BUG-001
**발견일**: YYYY-MM-DD
**심각도**: Critical / High / Medium / Low
**재현 절차**:
1. ...
2. ...
3. ...

**기대 결과**: ...

**실제 결과**: ...

**스크린샷/로그**: (있는 경우)
```

---

## 10. 테스트 완료 체크리스트

- [ ] 테스트 환경 설정 완료
- [ ] 핵심 시나리오 테스트 완료
- [ ] 에지 케이스 테스트 완료
- [ ] API 엔드포인트 테스트 완료
- [ ] 프론트엔드 UI 테스트 완료
- [ ] 통합 테스트 완료
- [ ] 성능 테스트 완료 (선택적)
- [ ] 테스트 리포트 작성 완료
- [ ] 발견된 버그 리포트 작성 완료

---

**다음 단계**: 테스트 환경을 구동하고 실제 테스트를 시작합니다.

